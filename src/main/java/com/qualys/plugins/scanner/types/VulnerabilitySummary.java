package com.qualys.plugins.scanner.types;

import java.io.Serializable;

/**
 * Summary of vulnerabilities found during a scan.
 */
public class VulnerabilitySummary implements Serializable {
    private static final long serialVersionUID = 1L;

    private int total;
    private int critical;
    private int high;
    private int medium;
    private int low;
    private int informational;

    public VulnerabilitySummary() {
    }

    public VulnerabilitySummary(int total, int critical, int high, int medium, int low, int informational) {
        this.total = total;
        this.critical = critical;
        this.high = high;
        this.medium = medium;
        this.low = low;
        this.informational = informational;
    }

    public int getTotal() { return total; }
    public void setTotal(int total) { this.total = total; }

    public int getCritical() { return critical; }
    public void setCritical(int critical) { this.critical = critical; }

    public int getHigh() { return high; }
    public void setHigh(int high) { this.high = high; }

    public int getMedium() { return medium; }
    public void setMedium(int medium) { this.medium = medium; }

    public int getLow() { return low; }
    public void setLow(int low) { this.low = low; }

    public int getInformational() { return informational; }
    public void setInformational(int informational) { this.informational = informational; }

    public void increment(int severity) {
        total++;
        switch (severity) {
            case 5:
                critical++;
                break;
            case 4:
                high++;
                break;
            case 3:
                medium++;
                break;
            case 2:
                low++;
                break;
            case 1:
            default:
                informational++;
                break;
        }
    }

    public void incrementBySeverityName(String severityName) {
        if (severityName == null) {
            increment(1);
            return;
        }
        switch (severityName.toLowerCase()) {
            case "critical":
                increment(5);
                break;
            case "high":
                increment(4);
                break;
            case "medium":
                increment(3);
                break;
            case "low":
                increment(2);
                break;
            default:
                increment(1);
                break;
        }
    }

    @Override
    public String toString() {
        return String.format(
            "Vulnerabilities: %d total (Critical: %d, High: %d, Medium: %d, Low: %d, Info: %d)",
            total, critical, high, medium, low, informational
        );
    }
}
